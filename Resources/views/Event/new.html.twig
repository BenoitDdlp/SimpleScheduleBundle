{% extends "IDCISimpleScheduleBundle::adminbase.html.twig" %}

{% block body %}

{{ parent() }}

<div class="page-header">
  <h1>{% trans %}Event creation{% endtrans %}</h1>
</div>

<form action="{{ path('admin_event_create') }}" method="post" {{ form_enctype(form) }}>
    {{ form_widget(form) }}
    <p>
        <button type="submit" class="btn btn-primary">{% trans %}Create{% endtrans %}</button>
    </p>
</form>

<script type="text/javascript">
    // Get the div that holds the collection of tags
    var collectionHolder = $('#idci_simpleschedule_event_type_xproperties');

    // setup an "add a property" link
    var $addPropertyLink = $('<a href="#" class="add_propery_link">Add a xproperty</a>');
    var $newLink = $('<div></div>').append($addPropertyLink);

    jQuery(document).ready(function() {
        // add the "add a propery" anchor and li to the xproperties ul
        collectionHolder.append($newLink);

        $addPropertyLink.on('click', function(e) {
            // prevent the link from creating a "#" on the URL
            e.preventDefault();

            // add a new tag form (see next code block)
            addXProperyForm(collectionHolder, $newLink);
        });
    });

    function addXProperyForm(collectionHolder, $newLink) {
        // Get the data-prototype explained earlier
        var prototype = collectionHolder.attr('data-prototype');

        // Replace '__name__' in the prototype's HTML to
        // instead be a number based on the current collection's length.
        var newForm = prototype.replace(/__name__/g, collectionHolder.children().length);

        // Display the form in the page in an li, before the "Add a propery" link li
        var $newForm = $('<div></div>').append(newForm);
        $newLink.before($newForm);
    }
</script>


<ul class="record_actions">
    <li>
        <a class="btn" href="{{ path('admin_event') }}">
            {% trans %}Back to the list{% endtrans %}
        </a>
    </li>
</ul>
{% endblock body %}
